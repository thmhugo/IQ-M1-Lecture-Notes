\documentclass{article}
\usepackage[utf8]{ inputenc }
\usepackage{ graphicx }
\graphicspath{ {img/} }
\usepackage{ geometry}
\geometry{legalpaper, margin=1.3in}
\usepackage{ bbm }
\usepackage{ braket }
\usepackage{ mathrsfs }
\usepackage{ amssymb }
\usepackage{ mathtools }
\usepackage{ amsfonts }
\usepackage{ caption }
\usepackage{ enumitem }
\usepackage{ tikz }
\usetikzlibrary{ quantikz }
\usepackage[hidelinks]{ hyperref }
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}

\usepackage{ fancyhdr }
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LOE]{\leftmark}
\fancyfoot[COE]{\thepage}

% = with "def" above.
\newcommand\eqdef{\mathrel{\overset{\makebox[0pt]{\mbox{\normalfont\tiny\sffamily
def}}}{=}}}
% = with "goal" above.
\newcommand\eqgoal{\mathrel{\overset{\makebox[0pt]{\mbox{\normalfont\tiny\sffamily
goal}}}{=}}}
% kind of small matrices but not optimal.
\newcommand{\colvec}[2][.8]{%
  \scalebox{#1}{%
    \renewcommand{\arraystretch}{.7}%
    $\begin{bmatrix}#2\end{bmatrix}$%
  } }

\title{qk4cs}
\author{}
\date{2021/2022}

\begin{document}

\begin{titlepage}
\begin{center}

\textsc{\LARGE Sorbonne Universite} \\[1cm]
\textsc{\LARGE Master 1 - Quantum Information} \\[1cm]
\textsc{\Large 2021/2022} \\[7cm]


{\huge \bfseries Lecture notes} \\[0.5cm]
{\huge \bfseries -} \\[0.5cm]
{\huge \bfseries Quantum Kinematic} \\[4cm]
\vfill
\end{center}
\end{titlepage}

\tableofcontents

\newpage

\section{Introduction}
Physical system which has $d \in \mathbbm{N}$ possible distinguishable states.
Its physical state $\ket{\psi} \in \mathscr{H}$, the Hilbert space
$\mathbbm{C}^d$.

\begin{equation}
    \ket{\psi} = \begin{bmatrix} \psi_1\\ \psi_2 \\ \vdots \\ \psi_d\end{bmatrix}
    \text{ and } \forall i, \psi_i \in \mathbbm{C}.
\end{equation}


\noindent
The result of the measurement in the computational basis on $\ket{\psi}$ is $i
\in [1, \cdots, d]$ with probability $|\psi_i|^2$. \\ \noindent And
$\sum_{i=1}^d |\psi_i|^2 = \braket{\psi|\psi} = 1$: the state is normalized.

\subsection{Dirac notation}

\begin{itemize}[label=-]

\item Ket:
\begin{equation}
\ket{\psi} = \begin{bmatrix} \psi_1\\ \vdots \\ \psi_d\end{bmatrix} = \psi_1 \ket{1} + \cdots + \psi_d\ket{d} = \sum_{i=1}^d \psi_i\ket{i}
\end{equation}
\item Bra:
\begin{equation}
\bra{\psi} = \ket{\psi}^\dagger = \ket{\psi^*}^T
\end{equation}
\item Braket:
\begin{equation}
\braket{\psi|\phi}
= \begin{bmatrix} \psi_1^* \cdots \psi_d^*\end{bmatrix} \begin{bmatrix} \phi_1\\ \vdots \\ \phi_d\end{bmatrix}
= \psi_1^*\phi_1 + \cdots + \psi_d^*\phi_d
\end{equation}
$\braket{\psi|\phi} $ is the hermitian product of $\psi$ and $\phi$.
\end{itemize}

\subsection{Measurement in a basis \texorpdfstring{$B$}{Lg}} $B$ is an
orthonormal basis : $B := \{\ket{b_i}\}_{i=1}^d$, with the following properties:
\begin{equation}
    \begin{aligned}
        \forall i \braket{b_i|b_i} = \delta_{i, j} & \text{ \textit{ (orthonormality)}} \\
        \sum_{i=1}^d\ket{b_i}\bra{b_j} = I & \textit{ (completeness)}
    \end{aligned}
\end{equation}

\begin{figure}[h]
\centering
\begin{quantikz}
    \lstick{$\ket{\psi}$} & \qw & \meter{$B$} & \qw \arrow[r] & \rstick{$i$} \qw
\end{quantikz}
\caption{Circuit representation of the measurement of the state $\ket{\psi}$\\
in the basis $B$.}
\end{figure}

\noindent
The probability of the output of a measurement is given by the following formula
:
\begin{equation}
    \mathbbm{P}(out=\ket{b_i}) = |\braket{b_i|\psi}|^2
\end{equation}
The physical object is projected into the state $\ket{b_i}$, this is physically
called the "wave packet reduction".

\subsubsection*{Qubit}
\begin{equation}
    \ket{0}= \begin{bmatrix} 1 \\ 0 \end{bmatrix}
    \hspace{1.2in}
    \ket{1}= \begin{bmatrix} 0 \\ 1 \end{bmatrix}
\end{equation}
\begin{equation}
    \ket{+} = \frac{1}{\sqrt2}(|0\rangle + |1\rangle)
    \hspace{0.7in}
    \ket{-}= \frac{1}{\sqrt2}(|0\rangle - |1\rangle)
\end{equation}

\subsubsection*{Measurement in the basis \texorpdfstring{$\{\ket{\pm}\}$}{Lg}}
\begin{figure}[h]
\centering
\begin{quantikz}
    \lstick{$\ket{0}$} & \qw & \meter{$\pm$} & \qw \arrow[r] & \rstick{$
        \begin{cases}
            +, & \text{w.p. $|\braket{+|0}|^2=\frac{1}{2}$}\\
            -, & \text{w.p. $|\braket{-|0}|^2=\frac{1}{2}$} \end{cases}$} \qw
\end{quantikz}
\caption{Measure of the state $\ket{0}$ in the basis $\ket{\pm}$}
\end{figure}

\subsection{Wiesner's Quantum Money}
Based on the conjugate coding.

\begin{itemize}[label=-]
    \item \texttt{bills}:
    \begin{itemize}
        \item serial number
        \item a set of random qubit $E_r \in \{\ket{0}, \ket{1}, \ket{+},
        \ket{-}\}^n$
        \item \texttt{mint} knows $\{\text{Serial Number}+\text{Random}\}$,
        sends it to the bank.
    \end{itemize}
    \item \texttt{Mint}: makes the bill, and gives it to the forger.
    \item \texttt{Forger}: tries to copy the bill, and spends the two to the
    bank.
    \item \texttt{Bank}: should accept the true one, reject the fake.
\end{itemize}

\begin{table}[h]
    \centering
    \begin{tabular}{c|c|c|c}
    \texttt{mint} & \texttt{forger} basis & \texttt{forger} m. & \texttt{bank}
    m. \\
    $\ket{0}$ & $\{\ket{0}, \ket{1}\}$ & $\ket{0}$ & $\ket{0} $\\
    $\ket{0}$ & $\{\ket{\pm}\}$ & $\begin{cases} \ket{+}, & \text{w.p.
    $\frac{1}{2}$}\\
        \ket{-}, & \text{w.p. $\frac{1}{2}$} \end{cases}$ & $\begin{cases}
    \ket{0}, & \text{w.p. $\frac{1}{2}$}\\
        \ket{1}, & \text{w.p. $\frac{1}{2}$} \end{cases}$
    \end{tabular}
\end{table}

We therefore deduce that
\begin{equation}
\mathbbm{P}(\text{get caugth})= 1-(1-\frac{1}{4})^n = 1-(\frac{1}{4})^n
\end{equation}

\subsection{Bennett and Brassard Quantum Key Exchange: BB84}
Goal: Alice and Bob $\rightarrow$ share a secret bit string , Eve does not know
anything. \\
Settings: Alice and Bob share a quantum channel and an authenticated classical
channel. \\\noindent Steps:
\begin{enumerate}
    \item Alice prepares $n$ qubits $E_r \in \{\ket{0}, \ket{1}, \ket{+},
    \ket{-}\}^n$, and she sends them to Bob
    \item Bob receives . He measures them in the basis $\{B_{0,1}, B_{+,-}\}$
    \item They use the public classical channel to compare the basis Bob used.
    They throw away the \textit{bad basis} qubits.
    \item Alice and Bob sample the data and compare the error rate $e$. If
        $e=0$, they keep the key; if $e = 25\%$, Eve knows the key.
\end{enumerate}
What if $0 < e < 25$ ? Eve knows a part of the key.
\section{Unitary transformation}
A transformation is an isolated system, and it is reversible. \\
Let $T$ to be a transformation.
\begin{equation}
    \braket{T(\ket{\psi})|T(\ket{\psi})}=\braket{\psi|\psi}
\end{equation}
$T$ is linear.
\begin{equation}
    T(\alpha\ket{\psi} + \beta\ket{\phi}) = \alpha T(\ket{\psi}) + \beta T(\ket{\phi})
\end{equation}

$T$ acts like an unitary operator. $T$ corresponds to a complex matrix $U$:
$T(\ket{\phi}) = U\ket{\phi}$, $U \in \mathbbm{C}^{n \times n}$, such that
$U^\dagger U= Id$.

In the basis $\{\ket{i}\}_{i=0}^n$,$\braket{T(\ket{\psi})|T(\ket{\psi})} =
\braket{i|j} = \delta_{i,j}$
%TODO : add the proof
\\
\\
We have :
\begin{itemize}[label=-]
    \item measurement in computational basis
    \item a machine making arbitrary unitary $U$
\end{itemize}
Let's build a measurement in basis $\{\ket{b_i}\}_i$

\begin{figure}[h]
    \centering
    \begin{quantikz}
        \lstick{$\ket{\psi}$} & \qw & \gate{U} & \phase{U\ket{\psi}}&\meter{} &
        \qw \arrow[r] & \rstick{$i$} \qw
    \end{quantikz}
    \caption{Circuit representation of the measurement unitary exptected behavior}
\end{figure}
\begin{equation}
    \mathbbm{P}(i) \eqdef |\braket{i|U|\psi}|^2 \eqgoal |\braket{b_i|\psi}|^2 \quad \forall \psi
\end{equation}
We want $\bra{i}U=\bra{b_i} \Leftrightarrow U^\dagger\ket{i} = \ket{b_i}
\Leftrightarrow U = \sum_i \ket{i}\bra{b_i}$
% TODO : add the proof

Is $U$ an unitary ?

\begin{equation}
    \begin{aligned}
        U^\dagger U &= \Big(\sum_i \ket{b_i}\bra{i}\Big)\Big(\sum_j\ket{j}\bra{b_j}\Big) \\
        &= \sum_{i, j}\ket{b_i}\braket{i|j}\bra{b_j} \\
        &= \sum_i \ket{b_i}\bra{b_i} \\
        &= Id & U \text{ is an unitary. }
    \end{aligned}
\end{equation}

\section{Composition of systems}
Let $A \in \mathscr{H}_A = \mathbbm{C}^{d_A}$ and $B \in \mathscr{H}_B =
\mathbbm{C}^{d_B}$ to be two systems in their respective vector spaces. Then we
can construct the space
\begin{equation}
    \mathscr{H}_{AB} = \mathscr{H}_A \otimes \mathscr{H}_B
\end{equation}
Its orthonormal basis is $\{\ket{ij}_{AB}\}_{i, j}$, and
\begin{equation}
    \text{dim}\mathscr{H}_{AB} = \text{dim}\mathscr{H}_A \cdot \text{dim}\mathscr{H}_B
\end{equation}
\\\noindent If $\ket{\alpha} = \sum_i\alpha_i\ket{i}_A$ and $\ket{\beta} =
\sum_i\beta_i\ket{i}_B$, then
\begin{equation}
    \ket{\phi}_{AB}=\ket{\alpha} \otimes \ket{\beta} = \sum_{i,j}\alpha_i\beta_j\ket{i}_A\ket{j}_B
\end{equation}

and $\ket{\phi}_{AB} \in \mathscr{H}_{AB}$. $\ket{\phi}_{AB}$ is a joint state
of systems $A$ and $B$. \\\noindent The inner product between two basis states
can be defined as
\begin{equation}
    \braket{i,j|k,l}=\braket{i|k}_A\braket{j|l}_B = \delta_{ik}\delta_{jl}
\end{equation}
\\\noindent The most general state in the space $\mathscr{H}_{AB}$ can be
written
\begin{equation}
    \ket{\psi} = \alpha \ket{00} + \beta \ket{01} + \gamma \ket{10} + \delta \ket{11}
\end{equation}
with the usual condition for $\ket{\psi}$ to be normalized:
\begin{equation}
    |\alpha|^2+|\beta|^2+|\gamma|^2+|\delta|^2 = 1
\end{equation}
\\\noindent Not all states of $\mathscr{H}_{AB}$ are separable into one state of
$\mathscr{H}_{A}$ and one state of $\mathscr{H}_{B}$

For example : $\frac{1}{\sqrt{2}}(\ket{00} + \ket{11}) \in \mathscr{H}_{AB}$,
but $\nexists \ket{\alpha}\in \mathscr{H}_A, \ket{\beta}\in \mathscr{H}_B$, such
that \\\noindent $\ket{\alpha}\otimes\ket{\beta} = \frac{1}{\sqrt{2}}(\ket{00} +
\ket{11})$.

Necessary condition on the coefficients $(\alpha, \beta, \gamma, \delta)$ of a
state to be separable:
\begin{equation}
    \alpha\delta = \beta\gamma
\end{equation}

%TODO : add the part about the partial measurement
\subsection{No cloning theorem}
\begin{theorem}
    There is no unitary $U$ such that $\forall \ket{\psi} \in \mathscr{H},
    U\ket{\psi} = \ket{\psi} \otimes \ket{\psi} \in \mathscr{H} \otimes
    \mathscr{H}$.
\end{theorem}
\paragraph{Proof: }
Suppose there exists a such unitary U, then U is a cloning operator.
\begin{equation}
    \begin{aligned}
        \forall \ket{\psi}, U\ket{\psi} \eqdef \ket{\psi}\ket{\psi}
    \end{aligned}
\end{equation}

By computing the application of $U$ on the state $\ket{+}$, we get on the one
hand, by linearity of unitaries.
\begin{equation}
    U(\frac{\ket{0}+\ket{1}}{\sqrt{2}}) = \frac{\ket{00}+\ket{11}}{\sqrt{2}}
\end{equation}
\\
and on the other hand, by definition of the operator behavior
\begin{equation}
    U(\frac{\ket{0}+\ket{1}}{\sqrt{2}}) = \frac{\ket{0}+\ket{1}}{\sqrt{2}}
    \otimes \frac{\ket{0}+\ket{1}}{\sqrt{2}}
    =\frac{1}{2}(\ket{00}+\ket{01}+\ket{10}+\ket{11})
\end{equation}
\\
which is a contradiction. Then such a $U$ operator can not exist.

\subsection{Superdense coding}
\textit{Superdense coding} involves two parties, \texttt{Alice} and
\texttt{Bob}. The protocol allows \texttt{Alice} and \texttt{Bob} to share two
bits of information by exchanging just one qubit. Basically, \texttt{Alice} is
in possession of two classical bits of information, which she wishes to send to
\texttt{Bob}.

Suppose \texttt{Alice} and \texttt{Bob} initially share a pair of qubits in the
entangled state
\begin{equation}
    \ket{\psi} = \frac{\ket{00} + \ket{11}}{\sqrt{2}}
\end{equation}

Here is the procedure.

\begin{table}[h]
    \centering
    \begin{tabular}{c|c|c}
    The state \texttt{Alice} wants to send & The gate she applies & The states
    after \\
    00 & $I$ & $\frac{\ket{00} + \ket{11}}{\sqrt{2}} = \ket{\phi^+}$  \\
    01 & $Z$ & $\frac{\ket{00} - \ket{11}}{\sqrt{2}} = \ket{\phi^-}$ \\
    10 & $X$ & $\frac{\ket{10} + \ket{01}}{\sqrt{2}} = \ket{\psi^+}$ \\
    11 & $Y$ & $\frac{\ket{01} - \ket{10}}{\sqrt{2}} = \ket{\psi^-}$
    \end{tabular}
\end{table}

\texttt{Alice} send her qubit to \texttt{Bob} and he measures the resulting pair
in the base \\
$\{\ket{\phi^+}, \ket{\phi^-},\ket{\psi^+}, \ket{\psi^-}\}$. This is indeed a
basis, and its name is the \textit{Bell basis}, and the states are called the
\textit{Bell states}.


\subsection{Quantum teleportation}
%TODO: comes from on the the firsts TD

\section{Measurements}
\subsection{Projective measurement}
A projective measurement is described by an observable, a Hermitian operator.
They are defined by a set of projectors $\{\Pi_j\}_{j=1}^k, k \leq d$.\\
Projectors properties:
\begin{equation}
    \forall j, \Pi_j^2 = \Pi_j \qquad \Pi_j\Pi_i = \delta_{i,j}\Pi_j
\end{equation}
\\\noindent A projector is defined as follows:
\begin{equation}
    \Pi_j = \sum_{l=1}^{d_j}\ket{l_l^j}\bra{l_l^j}
\end{equation}
Upon measuring the state $\ket{\psi}$, the probability of getting result $j$ is
given by
\begin{equation}
    \braket{\psi|\Pi_j|\psi} = \| \Pi_j\ket{\psi}\|^2
\end{equation}
Given that outcome $j$ occured, the state of the quantum system immediately
after the measurement is
\begin{equation}
    \frac{\Pi_j\ket{\psi}}{\| \Pi_j\ket{\psi}\|^2}
\end{equation}

\subsection{Observables}
Observables correspond to physical quantities, with values in $\mathbbm{R}$.
They are well defined in a basis $\{\ket{b_i}\}_i$ (i.e $\forall \ket{b_i},
\exists a_i \in \mathbbm{R})$

\paragraph{Note :} $\alpha\ket{b_1} + \beta\ket{b_2}$ has \textbf{not always} a
well defined value. \\
\\
An observable is defined as follow:
\begin{equation}
    O \eqdef \sum_i o_i \underbrace{\ket{b_i}\bra{b_i}}_{\text{projector on $\ket{b_i}$}}
    = \sum_j o_j \Pi_j
\end{equation}
$O$ is diagonalizable by definition and $O^\dagger = O$: $O$ is hermitian.
\begin{equation}
\text{Shape of $O$ } :
\begin{pmatrix}
    o_1 & 0 & \cdots & 0 \\
    0 & o_2 & \cdots & \vdots \\
    \vdots  & \vdots  & \ddots & \vdots  \\
    0 & \cdots & \cdots & a_d
\end{pmatrix}
\end{equation}
The probability of getting the result $i$ by measuring $O$ on a state
$\ket{\psi}$ is
\begin{equation}
\mathbbm{P}\braket{\psi|\Pi_i|\psi}
\end{equation}
\subsubsection*{Expectation value and standard deviation}

The expectation value of $O$, written $\langle O\rangle$, is given by
\begin{equation}
    \begin{aligned}
        \langle O\rangle
            & = \sum_i o_i \mathbbm{P}(i\ket{\psi}) \\
            & = \sum_i o_i \|\Pi_i\ket{\psi}\|^2 \\
            & = \sum_i o_i \braket{\psi|\Pi_i|\psi} \\
            & = \bra{\psi}\sum_i o_i \Pi_i \ket{\psi} \\
            & = \braket{\psi | O |\psi}
    \end{aligned}
\end{equation}

From this formula for the expectation value follows a formula for the standard
deviation associated to the observation of $O$
\begin{equation}
    \Delta^2 O = \langle(O - \langle O \rangle)^2\rangle = \langle O^2 \rangle - \langle O \rangle^2
\end{equation}

\paragraph{Note:} If $\ket{\psi}$ is an eigenstate of $O$, then $O\ket{\psi} =
\lambda \ket{\psi}$. \\
Hence:
\begin{equation}
    \begin{aligned}
        \braket{O}
            & = \braket{\psi | O | \psi} \\
            & = \braket{\psi | \lambda | \psi} \\
            & = \lambda\braket{\psi|\psi } \\
            & = \lambda
    \end{aligned}
\end{equation}
\\
And:
\begin{equation}
    \begin{aligned}
        O\ket{\psi} = \braket{O} \ket{\psi}
            & \Rightarrow \Delta^2 O = (\lambda^2 - \lambda^2) = 0 \\
            & \Rightarrow \Delta O = 0
    \end{aligned}
\end{equation}

\subsubsection*{Commutators}
A key property of quantum physics is the existence of incompatible measurements:
for any physical property $A$, there exists another physical property $B$ which
is incompatible with $A$. The incompatible means it is physically impossible to
prepare a state $\ket{\psi}$ which gives perfectly predictible outputs for both
measurements $A$ and $B$. Let us first assume $A$ and $B$ to be observables. A
key property of this pair of observable is their commutator
\begin{equation}
    [A,B]:= AB-BA
\end{equation}

If $A$ and $B$ commute (i.e $[A,B]=0 \Leftrightarrow AB = BA$), there exists a
basis such that the result of a measurement of $A$ and a measurement of $B$ are
perfectly defined.

Conversely, if such a basis exists, then $[A,B]=0$

Therefore, if $A$ and $B$ do not commute, they correspond to incompatible
measurements. (The proofs are in the $4^{th}$ tutorial.)

\subsubsection*{The Robertson-Heisenberg uncertainty relation}
This relation evaluates the sharpness of two observables we will call $A$ and
$B$ through the standard deviations $\Delta A$ and $\Delta B$, and the states
that, for any state $\ket{\psi}$ and any observable $A$ and $B$

\begin{equation}
    \Delta A \Delta B \geq \frac{1}{2}|\braket{\psi|[A,B]|\psi}
\end{equation}

\subsubsection*{Anti-commutator}
The anti commutator of two observables $A$ and $B$ is defined by
\begin{equation}
    \{A,B\} = AB+BA
\end{equation}

\subsubsection*{Example}
Using the Pauli matrix $\sigma_x = X =
    \begin{bmatrix}
    0 & 1 \\
    1 & 0
    \end{bmatrix}
    = \ket{+}\bra{+} - \ket{-}\bra{-} $. \\\noindent Known results : $X\ket{+} =
    \ket{+}$ and $X\ket{-}=-\ket{-}$. \\\noindent We define
    $\ket{\theta}:=\cos\theta\ket{0}+\sin\theta\ket{1}$ \\\noindent Then
\begin{equation}
    \begin{aligned}
        \langle X \rangle_{\ket{\theta}}
            & = \braket{\theta | X |\theta} \\
            & = [\cos \theta \sin \theta]
                \begin{bmatrix}0 & 1 \\ 1 & 0 \end{bmatrix}
                \begin{bmatrix} \cos \theta\\ sin \theta \end{bmatrix} \\
            & = 2 \sin\theta\cos\theta \\
            & = \sin (2\theta)
    \end{aligned}
\end{equation}


\subsection{Generalized measurements}
A generalized measurement is defined by
\begin{equation}
    \{K_i\}_i \text{ such that } \sum_i K_i^\dagger K_i=Id
\end{equation}
where the $K_i$ are called Kraus Operators. The probability of getting the
result $i$ from a general measurement operator is given by $\mathbbm{P}(i) =
\|K_i\ket{\psi}\|^2$ , and the state of the system just after the measurement is
$K_i\ket{\psi}=\frac{K_i\ket{\psi}}{\|K_i\ket{\psi}\|^2}$

\subsubsection*{Generalized measurement $\rightarrow$ Operator}
If $i \in \{1\}$ then $K_1^\dagger K_1=Id \Rightarrow K_1$ is
unitary.%FIXME: not sure of that.

\subsubsection*{Generalized measurement $\rightarrow$ Set of projectors}
If $K_i := \Pi_i$ then $\sum_i K_i^\dagger K_i = \sum_i \Pi_i^\dagger\Pi_i =
\sum_i \Pi_i = Id$

\subsubsection*{Example}
With prob. $P_j$, I measure $\{\Pi_{ij}\}_i \text{ } (\sum_i \Pi_{ij} = Id)$ and
I measure $U_j$ on the output state.
%TODO : add the scheme
Probability of getting $ij$ :
\begin{equation}
    \begin{aligned}
        \mathbbm{P}(ij)
            &= P_j\braket{\psi | \Pi_{ij} U^\dagger U \Pi_{ij} | \psi} \\
            &= P_j\braket{\psi|\Pi_{ij}|\psi}
    \end{aligned}
\end{equation}
\noindent
And the resulting state is
$\dfrac{U\Pi_{ij}\ket{\psi}}{\|\Pi_{ij}\ket{\psi}\|^2}$

\noindent
Let $\{K_{ij} =\sqrt{P_j} U \Pi_{ij}\}_{ij}$, then
\begin{equation}
    \begin{aligned}
        \sum_{ij} K_{ij}^\dagger K_{ij}
            & = \sum_{ij} P_j \Pi_{ij} U^\dagger U \Pi_{ij} \\
            & = \sum_j P_j \sum_i \Pi_{ij} \\
            & = \sum_j P_j \\
            & = Id
    \end{aligned}
\end{equation}
\noindent
Can we associate each set $\{K_i\}_i$ with a $U$ and a $\{\Pi_i\}_i$ ?
\begin{figure}[h]
    \centering
\begin{quantikz}
        \lstick{$\ket{\psi}_I$} & \qw \gategroup[2,steps=5,style={dashed,rounded
        corners,fill=blue!20, inner xsep=2pt},background]{{\sc $\{K_i\}_i$}} &
        \qw & \qw & \gate[2]{U} & \qw\arrow[r] & & \text{ouput $o$} \\
        & & & \lstick{   $\ket{0}_A$} & \qw & \meter{M$\{\ket{i}\}$} & \qw
        \arrow[r] & \text{ }i
    \end{quantikz}
    \caption{Circuit representation of such $U$ and $\{\Pi_i\}_i$. \\
    Note: $\mathscr{H}_A\otimes \mathscr{H}_I =
    \mathscr{H}_O\otimes\mathscr{H}_M$}
\end{figure}
\\\noindent $\forall i,$ the output state of the system is
\begin{equation}
    \label{output-state-kraus}
    (I_o \otimes \ket{i}_M\bra{i})U\ket{\psi}\otimes\ket{0}_A = \ket{i}_M\braket{i|U|0}_A\ket{\psi}_I
\end{equation}
Assume $K_i = _M\braket{i|U|0}_A$. With (\ref{output-state-kraus}), we deduce
that the output state is $K_i\ket{\psi}$, w.p. $\braket{\psi|K_i^\dagger
K_i|\psi}$. Is $\{K_i\}_i$ a valid set of operators ?
\begin{equation}
    \begin{aligned}
        \sum_i K_i^\dagger K_i
        & = \sum_i (_A\bra{0}\otimes I_I) U^\dagger (\ket{i}_M \otimes I_O)(I_O \otimes
        _M\bra{i})U(I_I\otimes \ket{0}_A)\\
        & = (_A\bra{0}\otimes I_I)
        \underbrace{U^\dagger (
        \underbrace{
            \underbrace{
                \sum_i \ket{i}_M}_{=I_M}
                    \otimes I_O
            }_{=I_{OM}})
            (I_O \otimes _M\bra{i})
        }_{= I_{OA}}(I_I\otimes \ket{0}_A) \\
        & = (_A\bra{0}\otimes I_I)I_{OA}(I_I\otimes \ket{0}_A) \\
        & = I_O \qquad \text{$\{K_i\}_i$ is a valid set.}
    \end{aligned}
\end{equation}

\subsubsection*{$\{K_i\}_i \rightarrow$ Unitary} Let $U := \sum_i K_i \otimes
\ket{i}_{MA}\bra{0} + \cdots $. The $\cdots$ represents extra terms used to make
$U$ a unitary, but can be neglected in the computation. By tensoring with
$\ket{0}_A$, we obtain
\begin{equation}
    U\ket{\psi}\otimes \ket{0}_A = \sum_i K_i \ket{\psi}\otimes\ket{i}
\end{equation}
And then
\begin{equation}
    \begin{aligned}
        _A\braket{0 |U^\dagger U|0}_A
            & = _A\bra{0}(\sum_i\ket{0}_{AM}\bra{i} K_i^\dagger \cdot \sum_j
            K_j\ket{j}_{AM}\bra{0})\ket{0}_A \\
            & = \underbrace{_A\braket{0|0}_A}_{=1} \cdot \sum_{ij}(_M\bra{i}\otimes
            K_i^\dagger)(\ket{j}_M\otimes K_j) \underbrace{_A\braket{0|0}_A}_{=1} \\
            & = \sum_{ij}\underbrace{\braket{i|j}}_{\delta_{ij}} K_i^\dagger K_j \\
            & = \sum_i K_i^\dagger K_i \\
            & = Id
    \end{aligned}
\end{equation}
\subsection{POVMs}
POVMs means Projective Operator Valued Measure: differently from the projective
measurements, the POVM does not define the post-measurement state.\\
Recall that the probability of getting $i$, when the state is $\ket{\psi}$ is
\begin{equation}
\braket{\psi | K_i^\dagger K_i | \psi}
\end{equation}
Then let $E_i = K_i^\dagger K_i$.\\\noindent POVMs are then defined by the set
$\{E_i\}_i$, such that
\begin{equation}
\sum_i E_i = Id, \quad E_i\geq 0
\end{equation}
$E_i$ is semi-definite positive: $ \forall \psi, \braket{\psi|E_i|\psi} \geq 0$.
This implies that $E_i$ is hermitian, and all its eigenvalues are $\geq 0$.

\subsection{The global phase}\label{global-phase}
\begin{lemma}
The global phase is irrelevant.
\end{lemma}
Of couse, the state $\ket{\psi}$ is different from the state
$e^{i\phi}\ket{\psi}$

\paragraph{Proof: }
First, we have
\begin{equation}
    |\braket{\psi|e^{i\phi}|\psi}|^2 = |e^{i\phi}|^2 = 1
\end{equation}

Using the generalized measurements $\{K_i\}_i$ such that $\sum_i K_i^\dagger K_i
= Id$ \\\noindent Then:
\begin{equation}
    K_ie^{i\phi}\ket{\psi} = e^{i\phi}K_i\ket{\psi}
\end{equation}
\noindent
The phase of the input is the same as the phase of the output. \\\noindent And
\begin{equation}
    \begin{aligned}
        \|K_ie^{i\phi}\ket{\psi}\|^2_2
            & =\begin{cases}
               \| K_i \ket{\psi} \|_2^2 = & \sqrt{ \mathbb{P}(i\ket{\psi})} \\
               \|e^{i\phi} K_i\ket{\psi}\|_2^2 & \sqrt{\mathbb{P}(i|e^{i\phi}\ket{\psi})}
            \end{cases}
    \end{aligned}
\end{equation}
\\\noindent Hence, the global phase is irrelevant, and there is no way to
measure the global phase. \\\noindent However, the relative phase is important
for later computations.
\begin{equation}
    \frac{1}{\sqrt{2}}(\ket{0}+\underbrace{e^{i\phi}}_{\text{relative phase}}\ket{1})
\end{equation}

\subsection{General quantum state}
\subsubsection*{Number of parameters to describe a quantum state}
Let $\mathscr{H} = \mathbbm{C^d}$ and $\ket{\psi} \in \mathscr{H}: \ket{\psi} =
\sum_{i=0}^d \alpha_i \ket{i}$ , (with $\alpha_i \in \mathbbm{C}$ and $\sum_i
|\alpha_i|^2=1$). If we consider $\alpha_i \in \mathbbm{R}$ is the global phase,
then $2d-2$ real parameters are needed to represent the quantum state.

\subsubsection*{Example}
Qubit in $\mathscr{H}$:
\begin{itemize}[label=-]
    \item $d=2 \rightarrow 2\cdot2-2 = 2$ real parameters : $(\theta, \varphi)$.
    \item $d=3 \rightarrow 4$ real parameters.
\end{itemize}
A quantum state can be written, with the parameters $\theta$ and $\varphi$, as
\begin{equation}
    \ket{\theta, \varphi} = \cos \frac{\theta}{2}\ket{0} + e^{i\varphi}\sin \frac{\theta}{2}\ket{1}
\end{equation}

\section{Bloch sphere}
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.15]{bloch-sphere.png}
    \caption{Graphical representation of a quantum state in the Bloch sphere}
\end{figure}
\noindent
We will denote $\ket{\psi}$ as the vector $\vec{m}$
\begin{equation}
    \begin{aligned}
        \vec{m} & = \begin{bmatrix}
            u \\ v \\ w
        \end{bmatrix} \text{such that } u^2 + v^2 + w^2 = 1
    \end{aligned}
\end{equation}
\text{whose cartesian coordinates are \quad}
\begin{equation}
    \begin{aligned}
        \vec{m} & =
        \begin{bmatrix}
            \label{def-vect-m}
            \sin \theta \cdot \cos \varphi \\
            \sin \theta \cdot \sin \varphi \\
            \cos \theta &
        \end{bmatrix}
    \end{aligned}
\end{equation}
Are $\vec{m}$ and $\vec{-m}$ orthogonal ?
\begin{equation}
    \label{m-m-orthogonal}
    \begin{aligned} % le bordel
        \braket{m|-m}
            & = \braket{\theta,\varphi|\pi-\theta,\varphi+\pi[2\pi]} \\
            & = \Big(\cos\frac{\theta}{2}\bra{0}+e^{i\varphi}\sin\frac{\theta}{2}\bra{1}\Big)
                \Big(\underbrace{\cos(\frac{\pi}{2}-\frac{\theta}{2})}_{\sin\frac{\theta}{2}}
                \ket{0}+e^{i(\varphi+\pi)}
                \underbrace{\sin(\frac{\pi}{2}-\frac{\theta}{2})}_{
                \cos\frac{\theta}{2}}\ket{1}\Big) \\
            & = \cos\frac{\theta}{2}\sin\frac{\theta}{2}\braket{0|0}
                +e^{i\varphi}\sin\frac{\theta}{2}(-e^{i\varphi})\cos\frac{\theta}{2}\braket{1|1} \\
        \braket{m|-m}
            & = 0
    \end{aligned}
\end{equation}
Orthogonal states in the Hilbert space correspond to opposite vectors in the
Bloch sphere.

%TODO: add the part (and the sketch) about the mixed states

\section{Pauli operators}
\subsection{Pauli matrices and properties}
There are four extremely useful two by two matrices called the \textit{Pauli
matrices}.
$$
\begin{aligned}
    \sigma_0 \equiv I \equiv &
        \begin{bmatrix}
            1 & 0 \\ 0 & 1
        \end{bmatrix}
    \quad & \quad
    \sigma_1 \equiv \sigma_x = X \equiv &
        \begin{bmatrix}
            0 & 1 \\ 1 & 0
        \end{bmatrix}
    \\
    \sigma_2 \equiv \sigma_y \equiv Y \equiv &
        \begin{bmatrix}
            0 & -i \\ i & 0
        \end{bmatrix}
    \quad & \quad
    \sigma_3 \equiv \sigma_z \equiv Z \equiv &
        \begin{bmatrix}
            1 & 0 \\ 0 & -1
        \end{bmatrix}
\end{aligned}
$$
\subsubsection*{Properties}
\begin{itemize}[label=-]
    \item they are indeed hermitian:
    \begin{equation}
        \forall i \in \{1, 2, 3\} f\quad \sigma_i^\dagger\sigma_i = \sigma_i^2 = Id
    \end{equation}
    \item braket decomposition
    \begin{equation}
        \begin{aligned}
            \sigma_x & = \ket{0}\bra{1} + \ket{1}\bra{0}
            \\
            \sigma_y & = -i\ket{0}\bra{1} + i\ket{1}\bra{0}
            \\
            \sigma_z & = \ket{0}\bra{0} - \ket{1}\bra{1}
        \end{aligned}
    \end{equation}
    \item commutation relation % may put this in the commutator section
        \begin{equation}
            [X,Y] = 2iZ; \quad [Y, Z] = 2iX; \quad [Z,X] = 2iY
        \end{equation}
    and more generally:
        \begin{equation}
            [\sigma_i, \sigma_j] = 2i\varepsilon_{ikj}\sigma_k\quad\text{with }\varepsilon_{123} = 1 \text{ and } \varepsilon_{jik}=-\varepsilon_{ijk}
        \end{equation}

\end{itemize}

\subsubsection*{Expectation values of the operators}
\begin{itemize}[label=-]
    \item measure $\sigma_z$ on the state $\ket{\theta, \varphi}$
    \begin{equation}
        \begin{aligned}
            \braket{\sigma_z}
                & = \braket{\theta, \varphi|Z|\theta, \varphi} \\
                & = \frac{1}{2} + \frac{1}{2}\cos\theta - \frac{1}{2} + \cos\theta \\
                & = \cos \theta = w \text{  (the $w$ component of $\vec{m}$)}
        \end{aligned}
    \end{equation}
    \item measure $\sigma_x$ on the state $\ket{\theta, \varphi}$
    \begin{equation}
        \begin{aligned}
            \braket{\sigma_x}
                & = \braket{\theta, \varphi|X|\theta, \varphi} \\
                & = \Big(\cos\frac{\theta}{2}\bra{0}+e^{i\varphi}\sin\frac{\theta}{2}\bra{1}\Big)
                    + \underbrace{\Big(\cos\frac{\theta}{2}\ket{1}+e^{i\varphi}\sin\frac{\theta}{2}
                    \ket{0}\Big)}_{=X\ket{\theta, \varphi}} \\
                & = \cos\frac{\theta}{2}\sin\frac{\theta}{2}
                    \Big(\underbrace{e^{i\varphi}+e^{-i\varphi}}_{=2\cos\varphi}\Big)\\
                & = \sin\theta\cos\varphi = u \text{  (the $u$ component of $\vec{m}$)}
        \end{aligned}
    \end{equation}
    \item measure $\sigma_y$ on the state $\ket{\theta, \varphi}$
    \begin{equation}
        \begin{aligned}
            \braket{\sigma_y} = v
        \end{aligned}
    \end{equation}
    % Need to do the calculation by hand
\end{itemize}


\paragraph{Note: } The average value corresponds to the associated coordinates:
 $\vec{m} = \begin{bmatrix} \braket{X} \\ \braket{Y} \\ \braket{Z}
 \end{bmatrix}$. The set $(X, Y, Z)$ is tomographically complete.

\subsubsection*{Pauli matrices as unitary}

\begin{itemize}[label=-]
    \item $\sigma_z = \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}$
    \begin{equation}
        \begin{aligned}
            \sigma_z\ket{\theta, \varphi}
                & = \cos \frac{\theta}{2}\ket{0} - e^{i\varphi}\sin\frac{\theta}{2}\ket{1} \\
                & = \cos \frac{\theta}{2}\ket{0} + e^{i(\varphi + \pi)}\sin\frac{\theta}{2}\ket{1} \\
                & = \ket{\theta, \varphi + \pi} \\
                & = R_z(\pi)\ket{\theta, \varphi}
        \end{aligned}
    \end{equation}
    It is a rotation of an angle $\pi$ around the $z$ axis on the Bloch sphere.

    \item $\sigma_x = \begin{bmatrix} 0 & 1 \\Â 1 & 0 \end{bmatrix}$
    \begin{equation}
        \begin{aligned}
            \sigma_x\ket{\theta, \varphi}
                & = e^{i\varphi}\sin\frac{\theta}{2}\ket{0} + \cos\frac{\theta}{2}\ket{1} \\
                & = e^{i\varphi}\cos\frac{\pi-\theta}{2}\ket{0} +
                e^{-i\varphi}\sin\frac{\pi-\theta}{2}\ket{1} \\
                & = e^{i\varphi}\ket{\pi - \theta, -\varphi} \\
                & = R_x(\pi)\ket{\theta, \pi}
        \end{aligned}
    \end{equation}

    % Not sure of this
    \item $\sigma_y = \begin{bmatrix} 0 & -i \\ i & 0 \end{bmatrix}$
    \begin{equation}
        \begin{aligned}
            \sigma_y\ket{\theta, \varphi}
                & = i\cos\frac{\theta}{2}\ket{1} - ie^{i\varphi}\sin\frac{\theta}{2}\ket{0} \\
                & = i\cos\frac{\theta}{2}\ket{1} + ie^{i(\varphi+\pi)}\sin\frac{\theta}{2}\ket{0}\\
                & = ie^{i(\pi+\varphi)}\Big(e^{-i(\pi+\varphi)}
                \cos\frac{\theta}{2}\ket{1}+\sin\frac{\theta}{2}\ket{0}\Big) \\
                & = ie^{i(\pi+\varphi)}\Big(\cos\frac{\theta-\pi}{2}
                \ket{1}+e^{-i(\pi-\varphi)}\sin\frac{\pi-\theta}{2}\ket{1}\Big) \\
                & = ie^{i(\pi+\varphi)}\ket{\pi+\theta, -\pi-\theta} \\
                & = R_x(\pi)\ket{\theta, \varphi}
        \end{aligned}
    \end{equation}

\end{itemize}


\subsubsection*{Pauli Group}
The Pauli group is defined by the set $G_1 = \{\eta I, \eta\sigma_x,
\eta\sigma_y, \eta\sigma_z\}_{\eta\in\{\pm 1, \pm i\}}$.
\begin{itemize}[label=-]
    \item they are their own inverse : $\sigma_i^{-1}=\sigma_i$
    \item their product is in $G_1$:
    \begin{itemize}
        \item $\sigma_x\sigma_y=i\sigma_z=-\sigma_y\sigma_x$
        \item $\sigma_y\sigma_z=i\sigma_x=-\sigma_z\sigma_y$
        \item $\sigma_z\sigma_x=i\sigma_y=-\sigma_x\sigma_z$
    \end{itemize}
    \item the Pauli matrices anti-commute: $\{\sigma_i, \sigma_j\} = 0, \forall
    i \neq j$
\end{itemize}

\section{Generic observable}
\subsection{Projector onto \texorpdfstring{$\vec{m}$}{Lg} for an arbitrary
vector \texorpdfstring{$\ket{\theta, \varphi}$}{Lg}}

Following the definition (\ref{def-vect-m}) of the vector $\vec{m}$, we can
define a projector onto the vector $\vec{m}$ for any arbitrary state
$\ket{\theta, \varphi}$.

\begin{equation}
    \begin{aligned}
        \label{projector-onto-m}
        \ket{\vec{m}}\bra{\vec{m}}
            & = \cos^2\frac{\theta}{2}\ket{0}\bra{0}+\sin^2\frac{\theta}{2}\ket{1}\bra{1} +
                \cos\frac{\theta}{2}\sin\frac{\theta}{2}\Big(e^{i\varphi}\ket{1}\bra{0}+e^{i\varphi}
                \ket{0}\bra{1}\Big) \\
            & = \underbrace{\frac{1}{2}(1+\cos\theta)\ket{0}\bra{0}+
                \frac{1}{2}(1-\cos\theta)\ket{1}\bra{1}}_{\text{diagonal}} +
                \underbrace{\frac{1}{2}\sin\theta
                \Big(e^{i\varphi}\ket{1}\bra{0}+e^{-i\varphi}\ket{0}\bra{1}\Big)}_{
                \text{anti-diagonal part}} \\
            & = \frac{1}{2}\Big(I + \cos\theta\sigma_z + \sin\theta\cos\varphi\sigma_x +
            i\sin\theta\cos\varphi\sigma_y \Big) \\
            & = \frac{1}{2}\Big(I + u\sigma_x + v\sigma_y + w\sigma_z \Big) \\
            & = \frac{1}{2}(I+\vec{m}\vec{\sigma})
                \quad \text{ considering } \vec{\sigma}=\begin{bmatrix}\sigma_x & \sigma_y &
                \sigma_z\end{bmatrix}
    \end{aligned}
\end{equation}

\paragraph{Note: } Hence we can also express the projector onto $\vec{m}$ with
\begin{equation}
    \ket{\vec{m}}\bra{\vec{m}}= \frac{1}{2}\begin{bmatrix}
        1+w & u-iw \\ u+iw & 1-w
    \end{bmatrix}
\end{equation}
but the result found on (\ref{projector-onto-m}) is a more convinient notation.

\subsection{Generic observable}
Let
$\sigma_{\vec{m}}:=1\ket{\vec{m}}\bra{\vec{m}}-1\ket{-\vec{m}}\bra{-\vec{m}}$.
(recall from (\ref{m-m-orthogonal}), $\vec{m}$ and $-\vec{m}$ are orthogonal).

\begin{equation}
    \begin{aligned}
        \sigma_{\vec{m}}
            & = \ket{\vec{m}}\bra{\vec{m}}-\ket{-\vec{m}}\bra{-\vec{m}} \\
            & = \frac{1}{2}(I+\vec{m}\vec{\sigma}-I-(-\vec{m}\vec{\sigma})) \\
            & = \vec{m}\vec{\sigma}
    \end{aligned}
\end{equation}
\noindent
We have $\sigma_{\vec{m}}=\vec{m}\vec{\sigma}$ and
$\sigma_{\vec{m}}^\dagger=\sigma_{\vec{m}}$.

\begin{equation}
    \begin{aligned}
        \sigma_{\vec{m}}^2
            & = (u\sigma_x + v\sigma_y + w\sigma_z)(u\sigma_x + v\sigma_y + w\sigma_z) \\
            & = (u^2 + v^2 + w^2)I + uv (\sigma_x\sigma_y + \sigma_y\sigma_x) +
                uw (\sigma_x\sigma_z + \sigma_z\sigma_x) + \cdots \\
            & = \underbrace{(u^2 + v^2 + w^2)}_{=1 (\text{by def. \ref{def-vect-m}})}I +
                \underbrace{uv\{\sigma_x; \sigma_y\}}_{=0} + \underbrace{uw\{\sigma_x,
                \sigma_z\}}_{=0} \\
            & = I
    \end{aligned}
\end{equation}
$\sigma_{\vec{m}}$ corresponds to a rotation around the $\vec{m}$ axis.

\subsubsection*{Example}
\begin{equation}
% TODO rewrite the subscript in a better way.
\sigma_{\frac{1}{\sqrt{2}}\begin{bmatrix}1\\0\\1\end{bmatrix}} = H = \frac{1}{\sqrt{2}}
\colvec{1\\0\\1}
\end{equation}

\subsection{Arbitrary rotation}
The Pauli matrices $X$, $Y$ and $Z$ are so-called because when they are
exponentiated, they give rise to the \textit{rotation operators}, which rotate
the Bloch vector $\vec{m}$ around the $x, y$ and $z$ axis:
\begin{equation}
    \begin{aligned}
        R_x & \equiv e^{-i\frac{\theta}{2}X} \\
        R_y & \equiv e^{-i\frac{\theta}{2}Y} \\
        R_z & \equiv e^{-i\frac{\theta}{2}Z} \\
    \end{aligned}
\end{equation}


\subsubsection*{Example}
The hamiltonian of a system is given by the formula
\begin{equation}
        H=\frac{\hbar\omega}{2}\sigma_z
\end{equation}
And we can build an unitary that express the hamiltonian
\begin{equation}
    U(t) = e^{-\frac{i}{\hbar}Ht}=e^{-i\frac{\omega t}{2}\sigma_z}
    = \begin{bmatrix}
        e^{i\omega\frac{t}{2}} & \cdot \\ \cdot & e^{i\omega\frac{t}{2}}
    \end{bmatrix}
\end{equation}
By measuring the hamiltonian over time on the general state $\ket{\theta,
\varphi}$, we get that
\begin{equation}
    \label{hamiltonian-on-general-state}
    \begin{aligned}
        U(t)\ket{\theta, \varphi}
            & = e^{-i\frac{\omega t}{2}}\cos\frac{\theta}{2} +
                e^{+i(\frac{\omega t}{2}+\varphi)}\sin\frac{\theta}{2}\ket{1} \\
            & = e^{-i\frac{\omega t}{2}}\Big(\cos\frac{\theta}{2}\ket{0} +
                e^{i(\omega t + \varphi)}\sin\frac{\theta}{2}\ket{1}\Big) \\
            & = e^{-i\frac{\omega t}{2}}\ket{\theta, \varphi + \omega t}    \end{aligned}
\end{equation}
From (\ref{hamiltonian-on-general-state}), we can deduce that
\begin{equation}
    e^{-i\frac{\omega t}{2}\sigma_z}=R_z(\omega t)\cdot e^{-i\frac{\omega t}{2}}
    \quad \text{ with } R_z(\omega t) = \begin{bmatrix}
        1 & \cdot \\ \cdot & e^{i\omega t}
    \end{bmatrix}
\end{equation}

\paragraph{Note: }
The relative phase of $R_z(\omega t)$ and $U(t)$ are equal. \\\noindent From the
previous results, we can express an arbitrary rotation matrix $R_{\vec{m}}$ up
to a global phase.

\begin{equation}
    \begin{aligned}
        R_{\vec{m}}(\alpha)
            & = e^{-i\frac{\alpha}{2}\sigma_{\vec{m}}} \\
            & = \sum_{k=0}^\infty
             \frac{(-i \frac{\alpha}{2}\sigma_{\vec{m}})^k}{k!} \\
            & = \sum_{q=0}^\infty \Big(\frac{(-i)^{2q}(\frac{\alpha}{2})^{2q}}{(2q)!}I +
                \frac{(-i)^{2q+1}(\frac{\alpha}{2})^{2q+1}}{(2q+1)!}\sigma_{\vec{m}}\Big) \\
            & = \cos\frac{\alpha}{2}I - i\sin\frac{\alpha}{2}\sigma_{\vec{m}}
    \end{aligned}
\end{equation}

\section{Density matrix and density operator}

Until this part, we were using pure state, i.e. states $\ket{\psi} \in
\mathscr{H}$. In this part, we will study convexe mixtures/ensembles of pure
states, denoted by
\begin{equation}
    \{p_i, \ket{\psi_i}\}_i
\end{equation}
It corresponds to a set of states $\ket{\psi_i}$ that are associated to a
probability $p_i$. The density operator for the system is defined by the
equation
\begin{equation}
    \label{def-density-matrix}
    \rho \equiv \sum_ip_i\underbrace{\ket{\psi_i}\bra{\psi_i}}_{\text{density matrix}}
\end{equation}
The mean value of an observable $O$ can be expressed by the density operator
$\rho$:
\begin{equation}
    \label{expectation-value-and-trace}
    \begin{aligned}
        \braket{O}_{p_i, \{\psi_i\}}
            & = \sum_i p_i \underbrace{\braket{\psi_i|O|\psi_i}}_{\in \mathbbm{R}} \\
            & = \sum_i p_i \text{tr }(\braket{\psi_i|O|\psi_i}) \\
            & = \sum_i p_i \text{tr }(O\ket{\psi_i}\bra{\psi_i}) & \text{as tr($AB$)=tr($BA$)} \\
            & = \text{tr }\Big(\sum_ip_iO\ket{\psi_i}\bra{\psi_i}\Big) \\
            & = \text{tr }(O\rho) = \text{tr }(\rho O)
    \end{aligned}
\end{equation}

Suppose, for example, that the evolution of a closed quantum system is described
by the unitary operator $U$. If the system was initially in the state
$\ket{\psi_i}$, with probability $p_i$ then afer the evolution has occured the
system will be in the state $U\ket{\psi_i}$ with probability $p_i$. Thus, the
evolution of the density operator is described by the equation
\begin{equation}
    \rho=\sum_ip_i\ket{\psi_i}\bra{\psi_i} \overset{U}{\longrightarrow}
        \sum_ip_iU\ket{\psi_i}\bra{\psi_i}U^\dagger=U\rho U^\dagger
\end{equation}
Generalized measurements are also described with the density operator. Suppose
we perform a measurement described by the measurements operators $\{K_m\}_m$. If
the initial state was $\ket{\psi_i}$, then the probability if getting result $m$
is
\begin{equation}
    \begin{aligned}
        \mathbbm{P}(m|i)
            & = \braket{\psi_i|K_m^\dagger K_m |\psi_i} \\
            & = \text{tr}(K_m^\dagger K_m\ket{\psi_i}\bra{\psi_i})
    \end{aligned}
\end{equation}
We can interpret this formula as the mean value of the operator $K_m$ over the
subspace associated to $m$, and conclude using
(\ref{expectation-value-and-trace}).\\\noindent Hence, by the law of total
probabilities, the probability of obtaining the result $m$ is
\begin{equation}
    \begin{aligned}
        \mathbbm{P}(m)
            & = \sum_i p_i \mathbbm{P}(m|i) \\
            & = \sum_i p_i \text{tr }(K_m^\dagger K_m\ket{\psi_i}\bra{\psi_i}) \\
            & = \text{tr }(K_m^\dagger K_m \rho)
    \end{aligned}
\end{equation}
If the initial state was $\ket{\psi_i}$ then the state after obtaining the
result $m$ is
\begin{equation}
    \ket{\psi_i^m}
        = \frac{K_m\ket{\psi_i}}{\sqrt{\braket{\psi_i|K_m^\dagger K_m|\psi_i}}}
        = \frac{K_m\ket{\psi_i}}{\|K_m\ket{\psi_i}\|_2}
\end{equation}

\subsubsection*{Example}
\begin{equation}
    \{\big(p, \ket{0}\big), \big(1-p, \ket{1}\big)\}
\end{equation}

Does it exists a state $\ket{\psi}$ representing this ? Recall that for an
observable $O$
\begin{equation}
    \braket{O}=\sum_ip_i\braket{\psi_i|O|\psi_i}
\end{equation}
Then
\begin{equation}
    \begin{aligned}
        \braket{X}&=p\braket{0|X|0}+(1-p)\braket{1|X|1}=0=\braket{Y}
        \\
        \braket{Z}&=p\underbrace{\braket{0|Z|0}}_{=1} + (1-p)\underbrace{\braket{1|Z|1}}_{=-1} = 2p-1
    \end{aligned}
\end{equation}
We see that there is no intersection on the sphere. This implies that there is
no $\ket{\psi}$ representing this mixture.
%TODO: add the sphere.

\subsection{Properties of the density operator}
\label{density-matrix-properties}
In the case of a pure state, a system can be described both by a density
operator and by a state vector: with (\ref{def-density-matrix}), we can easily
see that the states $\ket{\psi}$ and $e^{i\varphi}\ket{\psi}$ have the same
density operator, hence they describe the same physical state. The density
operator therefore has the benefit of removing the arbitrary global phase of a
state, that we saw in section \ref{global-phase} (p.\pageref{global-phase}) that
it was irrelevant.\\
Other interesting properties of the density operator that come from its
definition:
\begin{itemize}[label=-]
    \item the density operator is hermitian
    \begin{equation}
        \rho = \rho^\dagger
    \end{equation}
    \item semi definite positive, hence its eigenvalues are greater or equal to
    zero.
    \begin{equation}
        \forall \ket{\psi}, \braket{\psi|\rho|\psi} \geq 0
    \end{equation}
    \item tr($\rho$) $\leq 1$
    \item tr($\rho^2$)=tr($\rho$)=1 if and only if the state is pure.
    \item $\rho$ is diagonalizable, i.e. $\exists \lambda_i \geq 0 : \rho =
        \sum_i \lambda_i \ket{e_i}\bra{e_i}$. And $\{e_i\}_i$ is the cannonical
        basis: $\forall i,j: \braket{e_i|e_j}=\delta_{ij}$
\end{itemize}

To any $\rho$ such that $\rho=\rho^\dagger$, $\rho \geq 0$ and tr($\rho$)=1
corresponds a matrix, since $\rho=\rho^\dagger$, there exists a set
$\{\ket{\psi_i}\}$ that form a basis such that
$\rho=\sum_i\lambda_i\ket{\psi_i}\bra{\psi_i}$.


\subsection{Bloch sphere for mixed states}
%TODO: add the sketch for the lecture notes.
Using the def. (\ref{def-vect-m}) of the vector $\vec{m}$ and the def.
(\ref{projector-onto-m}) of the projector onto this vector $\vec{m}$, we have
\begin{equation}
    \rho = \sum_ip_i\ket{\vec{m_i}}\bra{\vec{m_i}} = \frac{1}{2}\big(Id+\vec{\sigma}\cdot\sum_ip_i\vec{m_i}\big)
\end{equation}
Any measurement on $\rho$ leads to the same statistics independant of the
mixture.\\
In \texttt{BB84}:
$
\frac{1}{2}\ket{0}\bra{0} + \frac{1}{2} \ket{1}\bra{1}
=2Id=
\frac{1}{2}\ket{+}\bra{+} + \frac{1}{2} \ket{-}\bra{-}
$

\subsection{Composition}
As seen previouly, the state $\ket{\psi}_{AB} \in \mathscr{H}_A \otimes
\mathscr{H}_B$. From the fact that
\begin{equation}
    \ket{\psi'}_{AB} = \sum_{\psi, \phi}\ket{\psi_A}\otimes\ket{\phi_B}
    \neq \Big(\sum_{\psi}\ket{\psi}_A\Big) \otimes \Big(\sum_{\phi}\ket{\phi}_B\Big)
\end{equation}
We can see that the density operator for the composition is defined by
\begin{equation}
    \begin{aligned}
        \rho_{AB}
            & \equiv \sum_{\psi}\ket{\psi'}_{AB}\bra{\psi'}_{AB} \neq \sum \rho_A \otimes \rho_B \\
            & \equiv \sum_{\psi,\psi',\phi,\phi'}\ket{\psi}_A\bra{\psi'}\otimes\ket{\phi}_B\bra{\phi'}
    \end{aligned}
\end{equation}

\paragraph{Criterion to decide if a state is mixed or pure: }
Let $\rho$ to be in its diagonal form (as $\rho$ hermitian, if not diagonal, it
is diagonalizable). Then
\begin{equation}
    \begin{aligned}
        \text{tr } \rho^2
            & = \text{tr } \Big( U \begin{bmatrix}
                \lambda_1 & & \\ & \ddots & \\ & & \lambda_d
            \end{bmatrix}^2 U^\dagger \Big) \\
            &  = \text{tr } \Big( U \begin{bmatrix}
                \lambda_1^2 & & \\ & \ddots & \\ & & \lambda_d^2
            \end{bmatrix} U^\dagger \Big) \\
            & = \sum_i \lambda_i^2 \\
            & = 1 \qquad \text{ if and only if $\rho$ is pure}
    \end{aligned}
\end{equation}

\paragraph{Note: }From that we can express by $1-\text{tr }\rho^2$ the notion of
purity of a state.

\subsection{Partial trace}
Consider a two physical systems $A \in \mathscr{H}_A$ and $B \in \mathscr{H}_B =
\mathscr{H}_{AB}$. The space associated to the global system is
$\mathscr{H}_A\otimes\mathscr{H}_B$. Let $\{\ket{\psi_i}_A\}_i$ be a basis of
$A$ and $\{\ket{\psi_i}_B\}_i$ a basis of $B$.
$\{\ket{\psi_i}_A\ket{\psi_i}_B\}$ is a basis of $\mathscr{H}_{AB}$. The density
operator $\rho_{AB}$ acts on the whole system. We are going to define, starting
form $\rho_{AB}$, an operator $\rho_A$ (or $\rho_B$) that acts only on $A$ (or
$B$).

The reduced density operator for the system $A$ is $\rho_A$
\begin{equation}
    \rho_A \equiv
    \sum_k \bra{\psi_k}_B\rho\ket{\psi_k}_B
\end{equation}
$\rho_A$ is obtained from $\rho$ by computing the partial trace on the system
$B$
\begin{equation}
    \rho_A \equiv \text{tr}_B(\rho_{AB})
\end{equation}
We can deduce from the definitions of $\rho_{AB}$, $\rho_A$ and $\rho_B$, that
\begin{equation}
    \text{tr}(\rho) = \text{tr}_A(\text{tr}_B\rho) =
    \text{tr}_B(\text{tr}_A\rho)
\end{equation}
The trace of the state density operator acting on the system $AB$ is then
\begin{equation}
    \text{tr}\rho_{AB} =
    \sum_{i,k} \big(\bra{\psi_i}_A\bra{\psi_k}_B\big)\rho_{AB}\big(\ket{\psi_i}_A\ket{\psi_k}_B\big)
\end{equation}

\section{Tomography}
\subsection{Case of the qubit}
We start with $p^{\otimes n}$, that is, $n$ copies of an unknown state $p$. We
suppose, for simplicity, that all of these states are the same. The goal is to
write the state $p$, or any complete description of the state $p$. The procedure
is the following:
\begin{enumerate}
    \item Split the $n$ copies of the state into 3 sets of size $\frac{n}{2}$
    \item Measure $X, Y, Z$ on each set
    \item Then deduce the average values of the opertors
    \begin{equation}
        \braket{X} \approx \frac{1}{n/3}\sum_{i=1}^{n/3} x_i \qquad
        \braket{Y} \approx \frac{1}{n/3}\sum_{i=1}^{n/3} y_i \qquad
        \braket{Z} \approx \frac{1}{n/3}\sum_{i=1}^{n/3} z_i
    \end{equation}
    \item Finally
    \begin{equation}
        \rho = \frac{1}{2}\Big(Id + \braket{X}X+\braket{Y}Y+ \braket{Z}Z\Big)
    \end{equation}
\end{enumerate}

\subsubsection*{Exemple of problem}
%TODO: sketch the state outside the sphere TODO: complete this example
We could get something like $\braket{X}=\braket{Z}=1$ as outcome of the
measurement. This is physically impossible but could occur due to bad
measurement devices.

\subsection{Tomography of qubits}
For a system of dimension $d$, it is needed to have a tomographically complete
set of observables, which is a basis for the matrices verctor space. The inner
product in a matrices vector space can be defined as
\begin{equation}
    \label{def-h-s-inner-product}
    <A,B> = \text{tr}(A^\dagger B)
\end{equation}
and is called the Hilbert-Schmidt inner product.
\\
For instance if $d=2$, then we can use the basis $\mathscr{B}=\Big\{\dfrac{I}{\sqrt
2}, \dfrac{X}{\sqrt 2}, \dfrac{Y}{\sqrt 2}, \dfrac{Z}{\sqrt 2}\Big\}$ where we have
\begin{equation}
    \forall \sigma_i, \sigma_j \in \mathscr{B}, <\sigma_i, \sigma_j> = \delta_{ij}
\end{equation}
More generally, $\forall d \in \mathbbm{N}$, such a basis can be defined by
\begin{equation}
    \mathscr{B} =
        \underbrace{
            \big\{\ket{i}\bra{i}\big\}_i^d
        }_{
            \text{\Large$\mathbbm{1}_d$}
        } \cup
        \underbrace{
            \big\{\frac{\ket{i}\bra{j} + \ket{j}\bra{i}}{\sqrt 2}\big\}_{i<j}^d\cup
        }_{
            \dfrac{1}{\sqrt2}
            \begin{bmatrix}
                1 & \cdots & 1 \\
                \vdots & \ddots & \vdots \\
                1 & \cdots & 1
            \end{bmatrix}
        }
        \underbrace{
            \big\{\frac{i\ket{i}\bra{j} - i\ket{j}\bra{i}}{\sqrt 2}\big\}_{i<j}^d
        }_{
            \dfrac{i}{\sqrt2}
            \begin{bmatrix}
                1 & \cdots & \cdots & 1 \\
                -1 & \ddots & & \vdots \\
                \vdots & \ddots & \ddots & 1 \\
                -1 & \cdots & -1 & 1
            \end{bmatrix}
        }
\end{equation}
Where $\forall M \in \mathscr{B}, M^\dagger = M$ i.e each matrix of
$\mathscr{B}$ is hermitian, and $|\mathscr{B}|=d^2$. \\
The basis of a matrix vector space is indeed an orthonormal basis, then
\begin{equation}
    \begin{aligned}
        \rho
            & = \sum_{\sigma \in \mathscr{B}} <\sigma, \rho> \cdot \sigma & \\
            & = \sum_{\sigma \in \mathscr{B}} \text{tr}(\sigma^\dagger \rho) \cdot \sigma
                & \text{using eq. (\ref{def-h-s-inner-product})} \\
            & = \sum_{\sigma \in \mathscr{B}} \text{tr}(\sigma \rho) \cdot \sigma
                & \text{since $\sigma \in \mathscr{B}$ is hermitian} \\
            & = \sum_{\sigma \in \mathscr{B}}\braket{\sigma}_\rho\cdot \sigma &
    \end{aligned}
\end{equation}
Hence to reconstruct $\rho$ we only need to measure the average
$\braket{\sigma}_\rho$ for all $\sigma$. Since $|\mathscr{B}|=d^2$ and knowing
tr($\rho$) = 1, we need $d^2 - 1$ average measurements to reconstruct $\rho$ :

\begin{table}[h]
\centering
\begin{tabular}{r|cccc}
    number of qubits in $\rho$ & 1 & 2 & 3 & 5 \\ \hline
    average measurements needed & 3 & 15 & 63 & 1023
\end{tabular}
\caption{Number of average measurements needed for a n-qubits\\state reconstruction}
\end{table}
\noindent
The number of average measurement grows very fast, hence we need a more clever
way than \textit{brute force}, like compressed sensing (signal processing
technique for efficiently acquiring and reconstructing a signal), A.I, etc...

\section{Purification}
\paragraph{Schmidt decomposition: }
Suppose $\ket{\psi}_{AB}$ is a pure state of a bipartite system, $AB$. Then
there exist orthonormal states $\ket{e_i}_A$ for system $A$, and $\ket{e_i}_B$
for system $B$ such that
\begin{equation}
    \ket{\psi} = \sum_i\lambda_i \ket{e_i}_A \ket{e_i}_B
\end{equation}
where $\lambda_i \in \mathbbm{R^+}$ and are satisfying $\sum_i\lambda_i=1$, and
$\forall i,j \braket{e_i|e_j}=\delta_{ij}$.
%\subsection{Principle of purification}
\\ \\
The purification of a given density matrix $\rho$ is the process of getting the
associated quantum state. In other word it is the converse operation of the
trace: since given a state $\ket{\psi}_{AB}$, taking the trace of the state
gives us the density matrix $\rho_{AB}$, purifying the density matrix
$\rho_{AB}$ gives us the quantum state $\ket{\psi}_{AB}$.\\
The natural question that comes is: for all density matrix $\rho_A$ does it
exist a pure state $\ket{\psi}_{AB}$ such that $\text{tr}_B\ket{\psi}_{AB} =
\rho_B$ ? The answers is yes and the proof follows.

From section (\ref{density-matrix-properties}), any density matrix $\rho_A$ is
hermitian and semi-definite positive, i.e $\rho_A=\rho^\dagger_A$ and $\rho_A
\geq 0$, and $\rho_A$ is diagonalizable. From theses properties, one can express
$\ket{\psi}_{AB}$ in the cannonical basis $\{e_i\}_i$

If dim$\mathscr{H}_B \geq r$ (what is $r$ ?), then the state $\ket{\psi}_{AB}$
can be written
\begin{equation}
    \ket{\psi}_{AB} = \sum_{i=0}^r \sqrt{\lambda_i} \ket{e_i}_A\ket{b_i}_B
\end{equation}
where $\{b_i\}_i$ is an orthonormal basis of $\mathscr{H}_B$
\newpage
\section{Appendix}
%TODO: maybe put BB84 (+ B92 ?) and Quantum Teleportation in this part
\subsection{Non-orthogonal quantum states}
\subsubsection*{Distinguish non-orthogonal states}
\begin{theorem}
    Non-orthogonal states can not be reliably distinguish
\end{theorem}
Considering two non-orthogonal states $\ket{\psi_1}$ and $\ket{\psi_2}$, there
exist no quantum measurement that can distinguish reliably between those two
states, i.e. there can not exist a pair of operators $E_1$, $E_2$ such that
\begin{equation}
    \braket{\psi_1|E_1|\psi_1} = 1 \quad \braket{\psi_2|E_2|\psi_2} = 1
\end{equation}
Since $\sum_iE_i=Id$ it follows that $\sum_i\braket{\psi_1|E_i|\psi_1}=1$, and
since $\braket{\psi_1|E_1|\psi_1} = 1$ we must have $\braket{\psi_1|E_2
|\psi_1} = 0$ $\Rightarrow \sqrt{E_2}\ket{\psi_1}=0$. \\\noindent We can
decompose $\ket{\psi_2}$ as
\begin{equation}
    \ket{\psi_2} = \alpha\ket{\psi_1}+\beta\ket{\varphi}
\end{equation}
where $\braket{\psi_1|\varphi}=0$, $|\alpha|^2 +|\beta|^2 = 1$, and $|\beta|<1$
as $\ket{\psi_1}$ and $\ket{\psi_2}$ are not orthogonal. Based on our
assumption, we have
\begin{equation}
    \begin{aligned}
        \sqrt{E_2}\ket{\psi_1} = 0
        \Rightarrow \sqrt{E_2}(\ket{\psi_2} - \beta\ket{\varphi}) = 0
        \Rightarrow \sqrt{E_2}\ket{\psi_2} = \beta\sqrt{E_2}\ket{\varphi}
    \end{aligned}
\end{equation}
which implies that
\begin{equation}
    \braket{\psi_2|E_2|\psi_2} = |\beta|^2 \braket{\varphi|E_2|\varphi} \leq |\beta|^2 \leq 1
\end{equation}
where we used
\begin{equation}
\braket{\varphi|E_2|\varphi} \leq \sum_i\braket{\varphi|E_i|\varphi} = \braket{\varphi|\varphi} = 1
\end{equation}
Therefore our assumption contradicts the property of non-orthonormality of the
states $(|\beta|<1)$ and can not be true. Thus, one can't reliably distinguish
non-orthogonal states.
\end{document}